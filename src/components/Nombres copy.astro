---
// ComponenteConfirmarAsistencia.astro
---

<section class="relative bg-white w-full mt-8 py-4 px-6">
    
    <div class="max-w-lg mx-auto text-center">
        
        <!-- T√≠tulo "Confirma tu Asistencia" -->
        <div id="titulo-asistencia" class="mb-6">
            <h3 class="font-great-vibes text-5xl sm:text-6xl md:text-7xl text-[#C9A961] tracking-wide">
                Confirma tu Asistencia
            </h3>
        </div>

        <!-- Texto explicativo -->
        <div id="texto-asistencia" class="mb-6">
            <p class="text-[#6B6B6B] text-sm sm:text-base font-serif leading-relaxed">
                SER√Å DE MUCHA ALEGR√çA PARA NOSOTROS CONTAR<br />
                CON TU COMPA√ë√çA EN ESTE D√çA TAN IMPORTANTE.
            </p>
        </div>

        <!-- Texto de fecha l√≠mite -->
        <div id="texto-fecha-limite" class="mb-8">
            <p class="text-[#6B6B6B] text-sm sm:text-base font-serif leading-relaxed">
                POR FAVOR CONFIRMAR TU ASISTENCIA<br />
                HASTA EL 14 DE DICIEMBRE
            </p>
        </div>

        <!-- Formulario de confirmaci√≥n -->
        <div id="formulario-asistencia" class="mb-8 space-y-4">
            <!-- Input de nombre -->
            <div>
                <input 
                    type="text" 
                    id="nombre-invitado" 
                    placeholder="Tu nombre completo"
                    class="w-full px-4 py-3 border-2 border-[#C9A961] rounded-lg text-[#6B6B6B] font-serif text-sm sm:text-base focus:outline-none focus:border-[#6B7154] transition-colors"
                    required
                />
            </div>

            <!-- Input de cantidad de asistentes -->
            <div>
                <select 
                    id="cantidad-asistentes"
                    class="w-full px-4 py-3 border-2 border-[#C9A961] rounded-lg text-[#6B6B6B] font-serif text-sm sm:text-base focus:outline-none focus:border-[#6B7154] transition-colors"
                >
                    <option value="">¬øCu√°ntos asistir√°n?</option>
                    <option value="1">1 persona</option>
                    <option value="2">2 personas</option>
                    <option value="3">3 personas</option>
                    <option value="4">4 personas</option>
                    <option value="5">5 personas</option>
                </select>
            </div>
        </div>

        <!-- Bot√≥n "CONFIRMAR ASISTENCIA" -->
        <div id="boton-asistencia">
            <button 
                id="btn-confirmar"
                class="inline-block bg-[#6B7154] text-white px-8 py-3 rounded-lg text-sm sm:text-base font-serif uppercase tracking-wider hover:bg-[#5a5e45] transition-all duration-300 shadow-md hover:shadow-lg cursor-pointer"
            >
                CONFIRMAR ASISTENCIA
            </button>
        </div>

        <!-- Mensaje de √©xito ESTILO TICKET SIN ICONOS -->
        <div id="mensaje-exito" class="hidden mt-8">
            <div class="bg-white border-2 border-[#C9A961] rounded-xl p-8 transform shadow-lg">
                <!-- Texto de confirmaci√≥n TODO EN DORADO -->
                <h4 class="text-[#C9A961] text-2xl font-serif font-bold mb-4">
                    Confirmaci√≥n Enviada
                </h4>
                <p class="text-[#C9A961] text-base font-serif leading-relaxed">
                    Gracias por confirmar tu asistencia<br />
                    Nos vemos en el gran d√≠a
                </p>
            </div>
        </div>

    </div>

</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- üé¨ ANIMACIONES CON GSAP Y FUNCIONALIDAD WHATSAPP            -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    document.addEventListener("DOMContentLoaded", () => {
        console.log("‚úâÔ∏è Iniciando animaciones de confirmar asistencia...");

        // ‚ïê‚ïê‚ïê T√çTULO "CONFIRMA TU ASISTENCIA" ‚ïê‚ïê‚ïê
        gsap.fromTo(
            "#titulo-asistencia",
            { opacity: 0, y: -30 },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: "#titulo-asistencia",
                    start: "top 80%",
                    once: true
                }
            }
        );

        // ‚ïê‚ïê‚ïê TEXTO EXPLICATIVO ‚ïê‚ïê‚ïê
        gsap.fromTo(
            "#texto-asistencia",
            { opacity: 0, y: 20 },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: "#texto-asistencia",
                    start: "top 80%",
                    once: true
                },
                delay: 0.3
            }
        );

        // ‚ïê‚ïê‚ïê TEXTO FECHA L√çMITE ‚ïê‚ïê‚ïê
        gsap.fromTo(
            "#texto-fecha-limite",
            { opacity: 0, y: 20 },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: "#texto-fecha-limite",
                    start: "top 80%",
                    once: true
                },
                delay: 0.5
            }
        );

        // ‚ïê‚ïê‚ïê FORMULARIO ‚ïê‚ïê‚ïê
        gsap.fromTo(
            "#formulario-asistencia",
            { opacity: 0, y: 20 },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                ease: "power2.out",
                scrollTrigger: {
                    trigger: "#formulario-asistencia",
                    start: "top 80%",
                    once: true
                },
                delay: 0.6
            }
        );

        // ‚ïê‚ïê‚ïê BOT√ìN "CONFIRMAR ASISTENCIA" ‚ïê‚ïê‚ïê
        gsap.fromTo(
            "#boton-asistencia",
            { opacity: 0, scale: 0.8 },
            {
                opacity: 1,
                scale: 1,
                duration: 0.8,
                ease: "back.out(1.5)",
                scrollTrigger: {
                    trigger: "#boton-asistencia",
                    start: "top 80%",
                    once: true
                },
                delay: 0.8
            }
        );

        // ‚ïê‚ïê‚ïê FUNCIONALIDAD DEL BOT√ìN WHATSAPP ‚ïê‚ïê‚ïê
        const btnConfirmar = document.getElementById("btn-confirmar");
        const inputNombre = document.getElementById("nombre-invitado");
        const selectCantidad = document.getElementById("cantidad-asistentes");
        const formulario = document.getElementById("formulario-asistencia");
        const botonContainer = document.getElementById("boton-asistencia");
        const mensajeExito = document.getElementById("mensaje-exito");

        btnConfirmar?.addEventListener("click", () => {
            const nombre = inputNombre?.value.trim();
            const cantidad = selectCantidad?.value;

            // Validar que los campos est√©n completos
            if (!nombre) {
                // Animaci√≥n de error en el input
                gsap.to("#nombre-invitado", {
                    x: [-10, 10, -10, 10, 0],
                    duration: 0.4,
                    ease: "power2.out"
                });
                alert("Por favor, ingresa tu nombre completo");
                inputNombre?.focus();
                return;
            }

            if (!cantidad) {
                // Animaci√≥n de error en el select
                gsap.to("#cantidad-asistentes", {
                    x: [-10, 10, -10, 10, 0],
                    duration: 0.4,
                    ease: "power2.out"
                });
                alert("Por favor, selecciona cu√°ntas personas asistir√°n");
                selectCantidad?.focus();
                return;
            }

            // Construir el mensaje para WhatsApp SIN EMOJIS
// Construir el mensaje para WhatsApp SIN EMOJIS - USA ESTE C√ìDIGO
// Construir el mensaje para WhatsApp - SOLO TEXTO SIMPLE (sin emojis ni caracteres // Construir el mensaje para WhatsApp - SOLO TEXTO SIMPLE, SIN ACENTOS NI SIGNOS ESPECIALES
const mensaje = "Hola, confirmo mi asistencia a la boda. Nombre: " + nombre + ". Cantidad de asistentes: " + cantidad + " persona" + (cantidad > 1 ? "s" : "") + ". Nos vemos en el gran dia";

// N√∫mero de WhatsApp
const numeroWhatsApp = "59178762918";

// Crear URL de WhatsApp (sin espacios extra, y con encodeURIComponent)
const urlWhatsApp = "https://wa.me/" + numeroWhatsApp + "?text=" + encodeURIComponent(mensaje);

// Abrir WhatsApp
window.open(urlWhatsApp, "_blank");

            // ‚ïê‚ïê‚ïê ANIMACI√ìN DE √âXITO ‚ïê‚ïê‚ïê
            // Ocultar formulario y bot√≥n con animaci√≥n
            const timeline = gsap.timeline();
            
            timeline
                .to([formulario, botonContainer], {
                    opacity: 0,
                    y: -20,
                    duration: 0.5,
                    ease: "power2.in",
                    onComplete: () => {
                        formulario?.classList.add("hidden");
                        botonContainer?.classList.add("hidden");
                        mensajeExito?.classList.remove("hidden");
                    }
                })
                .fromTo(mensajeExito,
                    { 
                        opacity: 0, 
                        scale: 0.5,
                        y: 30
                    },
                    { 
                        opacity: 1, 
                        scale: 1,
                        y: 0,
                        duration: 0.6,
                        ease: "back.out(1.7)"
                    }
                );

            // Confetti opcional (part√≠culas de celebraci√≥n)
            crearConfetti();
        });

        // ‚ïê‚ïê‚ïê FUNCI√ìN PARA CREAR CONFETTI ‚ïê‚ïê‚ïê
        function crearConfetti() {
            const colors = ["#C9A961", "#6B7154", "#4ade80", "#fbbf24"];
            const confettiContainer = document.createElement("div");
            confettiContainer.style.cssText = "position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999;";
            document.body.appendChild(confettiContainer);

            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement("div");
                confetti.style.cssText = `
                    position: absolute;
                    width: 10px;
                    height: 10px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    top: 50%;
                    left: 50%;
                    opacity: 1;
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                `;
                confettiContainer.appendChild(confetti);

                gsap.to(confetti, {
                    x: (Math.random() - 0.5) * 800,
                    y: Math.random() * 600 - 300,
                    rotation: Math.random() * 360,
                    opacity: 0,
                    duration: 1.5 + Math.random(),
                    ease: "power2.out",
                    onComplete: () => {
                        confetti.remove();
                        if (confettiContainer.children.length === 0) {
                            confettiContainer.remove();
                        }
                    }
                });
            }
        }

        console.log("‚ú® Animaciones de confirmar asistencia completadas!");
    });
</script>

<style>
    /* Efecto hover en el t√≠tulo */
    #titulo-asistencia:hover {
        transform: scale(1.05);
        transition: transform 0.3s ease;
    }

    /* Animaci√≥n del bot√≥n al hacer clic */
    #boton-asistencia button:active {
        transform: scale(0.95);
    }

    /* Placeholder color */
    input::placeholder {
        color: #9CA3AF;
    }
</style>
```

